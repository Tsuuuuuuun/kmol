{
    "model": {
        "type": "protein_ligand",
        "protein_module": {
            "type": "linear",
            "in_features": 9723,
            "hidden_features": "{{{hidden_protein=32-256-16}}}",
            "out_features": 16
        },
        "ligand_module": {
            "type": "graph_convolutional",
            "in_features": 45,
            "out_features": 16,
            "hidden_features": "{{{hidden_ligand=32-256-16}}}",
            "dropout": "{{{dropout=0.0-0.7-0.1}}}",
            "layer_type": "{{{layer_type=torch_geometric.nn.GCNConv|torch_geometric.nn.GraphConv|torch_geometric.nn.GENConv|torch_geometric.nn.LEConv|torch_geometric.nn.SAGEConv|lib.model.layers.GINConvolution}}}",
            "layers_count": "{{{layers_count=2-8-1}}}",
            "molecule_features": 17,
            "is_residual": "{{{is_residual=0-1-1}}}",
            "norm_layer": "lib.model.layers.BatchNorm"
        },
        "hidden_features": 32,
        "out_features": 1
    },
    "loader": {
        "type": "csv",
        "input_path": "data/input/chembl/assay_ready.csv",
        "input_column_names": ["smiles", "target_sequence"],
        "target_column_names": ["label"]
    },
    "splitter": {
        "type": "index",
        "splits": {"train": 0.8, "test": 0.2}
    },
    "featurizers": [
        {
            "type": "graph",
            "inputs": ["smiles"],
            "outputs": ["ligand"],
            "descriptor_calculator": {"type": "rdkit"}
        },{
            "type": "bag_of_words",
            "inputs": ["target_sequence"],
            "outputs": ["protein"],
            "should_cache": true,
            "vocabulary": ["A", "C", "D", "E", "F", "G", "H", "I", "K", "L", "M", "N", "P", "Q", "R", "S", "T", "V", "W", "Y", "X"],
            "max_length": 3
        }
    ],
    "transformers": [],
    "optimizer": {
        "type": "{{{optimizer=torch.optim.SGD|torch.optim.Adam|torch.optim.AdamW|lib.model.optimizers.AdaBelief}}}",
        "lr": "{{{lr=0.0001-0.01-0.0001}}}",
        "weight_decay": "{{{weight_decay=0.00001-0.001-0.00001}}}"
    },
    "criterion": {
        "type": "torch.nn.BCEWithLogitsLoss"
    },
    "scheduler": {
        "type": "torch.optim.lr_scheduler.OneCycleLR",
        "max_lr": 0.01,
        "epochs": 50,
        "pct_start": 0.3,
        "div_factor": 25,
        "final_div_factor": 1000
    },
    "output_path": "data/logs/server/",
    "checkpoint_path": null,

    "threshold": 0.5,
    "cross_validation_folds": 5,
    "train_metrics": [],
    "test_metrics": ["roc_auc", "pr_auc", "accuracy", "precision", "recall"],

    "epochs": 50,
    "batch_size": 128,

    "use_cuda": true,
    "enabled_gpus": [0],

    "cache_location": "data/cache/",
    "clear_cache": false,

    "log_level": "info",
    "log_format": "",
    "log_frequency": 5,

    "observers": {},
    "target_metric": "roc_auc",
    "optuna_trials": 1000
}