{
    "model": {
        "type": "lrood",
        "model_configs": [
            {
                "type": "protein_ligand",
                "protein_module": {
                    "type": "linear",
                    "in_features": 9723,
                    "dropout": 0.1,
                    "hidden_features": 256,
                    "out_features": 128
                },
                "ligand_module": {
                    "type": "graph_convolutional",
                    "in_features": 45,
                    "out_features": 128,
                    "hidden_features": 1024,
                    "edge_features": 12,
                    "dropout": 0.1,
                    "layer_type": "torch_geometric.nn.LEConv",
                    "layers_count": 3,
                    "molecule_features": 17,
                    "is_residual": 1,
                    "read_out": "attention",
                    "norm_layer": "kmol.model.layers.BatchNorm"
                },
                "use_mi": true,
                "xavier_init": false,
                "hidden_features": 64,
                "out_features": 3
            },
            {
                "type": "protein_ligand",
                "protein_module": {
                    "type": "linear",
                    "in_features": 9723,
                    "dropout": 0.1,
                    "hidden_features": 256,
                    "out_features": 128
                },
                "ligand_module": {
                    "type": "graph_convolutional",
                    "in_features": 45,
                    "out_features": 128,
                    "hidden_features": 1024,
                    "edge_features": 12,
                    "dropout": 0.1,
                    "layer_type": "torch_geometric.nn.LEConv",
                    "layers_count": 3,
                    "molecule_features": 17,
                    "is_residual": 1,
                    "read_out": "attention",
                    "norm_layer": "kmol.model.layers.BatchNorm"
                },
                "use_mi": true,
                "xavier_init": false,
                "hidden_features": 64,
                "out_features": 3
            }
        ]
    },
    "loader": {
        "type": "csv",
        "input_path": "/nasa/datasets/kyodai_federated/proj_202208_202210/toxicity/mitotox_public.20220914.csv",
        "input_column_names": ["smiles"],
        "target_column_names": ["label"]
    },
    "num_workers": 8,
    "overwrite_checkpoint": true,
    "splitter": {
        "type": "random",
        "seed": 42,
        "splits": {"train": 0.8, "test": 0.1, "validation": 0.1}
    },
    "featurizers": [
        {
            "type": "graph",
            "inputs": ["smiles"],
            "outputs": ["graph"],
            "descriptor_calculator": {"type": "rdkit"}
        }
    ],
    "transformers": [],
    "inference_mode": "loss_aware",
    "mc_dropout_iterations": 10,
    "cross_validation_folds": 5,
    "train_metrics": ["roc_auc", "accuracy", "pr_auc"],
    "test_metrics": ["roc_auc", "accuracy", "pr_auc"],

    "epochs": 70,
    "batch_size": 128,

    "use_cuda": true,
    "enabled_gpus": [0],

    "cache_location": "data/cache/",
    "clear_cache": false,

    "log_level": "info",
    "log_format": "",
    "log_frequency": 5,

    "observers": {},
    "optuna_trials": 1000,

    "optimizer": {
        "type": "torch.optim.AdamW",
        "lr": 1.4e-5,
        "weight_decay": 4e-06
    },
    "criterion": {
        "type": "torch.nn.BCEWithLogitsLoss"
    },
    "scheduler": {
        "type": "torch.optim.lr_scheduler.OneCycleLR",
        "max_lr": 1.4e-4,
        "epochs": 70,
        "final_div_factor": 1000
    },
    "target_metric": "roc_auc",
    "output_path": "data/logs/bc4_lrodd_predict",
    "checkpoint_path": [
        "/nasa/shared_homes/loic/kyodai-kmol/kmol_internal_new/kmol-internal/data/logs/mitotox/2022-11-17_15-43/checkpoint_best.pt",
        "/nasa/shared_homes/loic/kyodai-kmol/kmol_internal_new/kmol-internal/data/logs/mitotox_lrodd/2022-11-18_15-35/checkpoint_best.pt"
    ]
}
